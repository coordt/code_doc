{% extends "code_doc/base_template.html" %}
{% load gravatar %}
{% load staticfiles %}
{% load author_image %}
{% load button_add_with_permission %}
{% load markdown_filter %}

{% block title %}{{ project.name }}{% endblock %}


{% block content %}
  <h1>{{ project.name }}</h1>

  {{ project.short_description }}

  <div class="row">
    <div class="col-md-8">
      <h3>Description</h3>
      {{ project.description_mk|markd|safe }}
    </div>
    <div class="col-sm-4">
      <h4>Authors</h4>
      {% if project.authors %}

        <div class="row">
          <div class="col-xs-8 col-sm-4">
				    {% for author in project.authors.all %}
		        <a href="{% url 'author' author.id %}" title="{{author.firstname}} {{author.lastname}}" alt="{{author.firstname}} {{author.lastname}}">
		          {% author_image author.id 50 %}
            </a>
            <div class="author-seperator"></div>
				    {% endfor %}
				  </div>

				</div>
      {% else %}
        <p>No author.</p>
      {% endif %}


      <h4>Maintained by</h4>
		  {% if project.administrators.count > 0 %}

		    <ul>
		    {% for maintainer in project.administrators.all %}
		      <li>
		        <a href="{% url 'maintainer' maintainer.id %}" >{{ maintainer.username }}</a>
		      </li>
		    {% endfor %}
		    </ul>

		  {% else %}
		      <p>No registered maintainer.</p>
		  {% endif %}

    </div>

  </div>


  <h3>Series {% button_add_series_with_permission user project %}
  </h3>

  {% if last_update %}

    <table class="table table-hover">
        <thead>
          <tr>
            <th>Series</th>
            <th>Visibility</th>
            <th>Release date</th>
            <th># files</th>
            <th>Last updated</th>
            <th>Description</th>

          </tr>
        </thead>

      {% for series, current_last_update in last_update.items %}

        <tbody>
          <tr>
            <th class="text-nowrap"><a href="{% url 'project_revision' project.id series.id %}" >{{ series.series }}</a></th>
            <td>
            {% if series.is_public %}
              <span class="label label-success">Public</span>
            {% else %}
              <span class="label label-warning">Restricted</span>
            {% endif %}</td>
            <td>{{ series.release_date }}</td>
            <td>{{ series.artifacts.count }}</td>
            <td>{{ current_last_update|date }}</td>
            <td>{{ series.description_mk|markd|safe }}</td>
          </tr>
         <tbody>

      {%endfor%}

    </table>

  {% else %}
      <p>No known released series.</p>
  {% endif %}

{% endblock %}
