{% extends "code_doc/base_template.html" %}
{% load staticfiles %}

{% block title %} {% if series.series %} {{series.series}} - {% endif %} {{ project.name }}{% endblock %}

{% block additionalhead %}
  <link rel="stylesheet" href="{% static "datepicker3.css" %}">
  <script language="javascript" type="text/javascript" src="{% static "bootstrap-datepicker.js" %}"></script>
{% endblock %}

{% block content %}

    {% if series.series  %}

      <h1>{{ project.name }} - Series <a href={% url 'project_series' project.id series.id %}>{{series.series}}</a></h1>
      <div class="alert alert-info" role="alert">
        You are editing the series details
      </div>

    {% else %}

      <h1> <a href={% url 'project' project.id %}>{{ project.name }}</a> </h1>
      <div class="alert alert-info" role="alert">
          You are adding a new series to the project {{ project.name }}.</br> 
      </div>
      
      <div class="alert alert-tip" role="alert">
          A serie is a line of development, and contains the artefacts of those developments. For instance "night-builds", "stable", "experimental", etc.</br>
          Once created, a serie can receive files, documentations, revision and branches.</br> 
          A serie can also have restricted accesses, which allows a subset of
          users sharing common interests on this line of development to access those artifacts.    
          
	  </div>	
    {% endif %}



    {% if form.errors %}
        <div class="alert alert-danger" role="alert">The following error occurred with your submission {{form.errors}}</div>
    {% endif %}



    <form class="form-horizontal" enctype="multipart/form-data" action="" method="post" role="form">
        {% csrf_token %}

        {% for field in automatic_fields %}
            <div class="form-group">
            
                {% if field.error %}
                <div class="alert alert-danger" role="alert">
                {{ field.errors }}
                </div>
                {% endif %}

                <label for="{{ field.id_for_label }}" class="col-sm-1 control-label">{{ field.label }}</label>
				
                <div class="col-sm-8">
                  {{ field }}
                </div>

                <div class="col-sm-3">
                	<p class="help-block">{{ field.help_text }}</p>
                </div>

            </div>
        {% endfor %}
        
        
        <h3>Permissions</h3>
        <p class="help-block">Indicate in the table below the permissions on this series granted to each user or group.</p>
        <table class="table table-hover table-condensed">
        <thead>
            <tr>
              <th width="30%">Users</th>
              {% for header in permission_headers %}
                <th>{{header}}</th>
              {% endfor %}
            </tr>
        </thead>

        <tbody>
            {% for index, user, checks in user_permissions %}
            <tr>
              <td width="30%">
                {{user}}
              </td>
              {% for check1 in checks %}
              <td>
                <label for="{{check1.id_for_label}}">
                <input
                {% if check1.is_checked %}
                checked="checked"
                {% endif %}
                id="{{check1.id_for_label}}" type="{{check1.input_type}}" value="{{check1.choice_value}}" name="{{check1.name}}"/>
                </label>
              </td>
              {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
        </table>

        <table class="table table-hover table-condensed">
         <thead>
           <tr>
             <th width="30%">Groups</th>
             {% for header in permission_headers %}
               <th>{{header}}</th>
             {% endfor %}
           </tr>
          </thead>

          <tbody>
            {% for index, group, checks in group_permissions %}
            <tr>
              <td width="30%">
                {{group}}
              </td>
              {% for check1 in checks %}
              <td>
                <label for="{{check1.id_for_label}}">
                <input
                {% if check1.is_checked %}
                checked="checked"
                {% endif %}
                id="{{check1.id_for_label}}" type="{{check1.input_type}}" value="{{check1.choice_value}}" name="{{check1.name}}"/>
                </label>
              </td>
              {% endfor %}             
            </tr>
            {% endfor %}
          </tbody>
        </table>

        {% if series.series %}
          <button type="submit" class="btn btn-info" />Save</button>
        {% else %}
          <button type="submit" class="btn btn-info" />Create</button>
        {% endif %}

    </form>

{% endblock %}
